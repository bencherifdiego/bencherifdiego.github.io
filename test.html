<!DOCTYPE html>
<html>
    <head>
        <title>WebSocket demo</title>
    </head>
    <body>
        <p id="dt">test</p>
        <p id="temp">temptest</p>
        <img id="img" src="">
        <script>
            var ws = new WebSocket("ws://127.0.0.1:1234/");
            ws.onmessage = function (event) {
                var 
                    content = document.createTextNode(event.data),
                    test = document.createTextNode(event.data),
                    img = document.createTextNode(event.data),
                    dt = document.getElementById('dt'),
                    temp = document.getElementById('temp');
                    image = document.getElementById('img');
                
                if (content.substringData(0, 2) == '0 ')
                {
                    dt.innerHTML = "";
                    dt.append(content.substringData(2, content.length - 2));
                }
                else if (content.substringData(0, 2) == '1 ')
                {
                    temp.innerHTML = "";
                    temp.append(test.substringData(2, test.length - 2));
                }
                else if (content.substringData(0, 2) == '2 ')
                {
                    var decodeTest = decode(img.substringData(2, img.length - 2))
                    image.src="";
                    image.src = "data:image/jpg;base64, " + decodeTest;
                }
            };

            function decode(s)
            {
                const unicodeString = s.replace(
                    /[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,
                    function(c) {
                        var cc = ((c.charCodeAt(0)&0x0f)<<12) | ((c.charCodeAt(1)&0x3f)<<6) | (c.charCodeAt(2)&0x3f);
                        return String.fromCharCode(cc);
                    }).replace(
                        /[\u00c0-\u00df][\u0080-\u00bf]/g,
                        function(c) {
                            var cc = (c.charCodeAt(0)&0x1f)<<6 | c.charCodeAt(1)&0x3f;
                            return String.fromCharCode(cc);
                        }
                    );
                return unicodeString;
            }
        </script>
    </body>
</html>